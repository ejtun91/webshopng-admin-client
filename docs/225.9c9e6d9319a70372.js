"use strict";(self.webpackChunkweb_admin=self.webpackChunkweb_admin||[]).push([[225],{225:(X,f,i)=>{i.r(f),i.d(f,{ProductModule:()=>j,routes:()=>A});var c=i(6895),l=i(6684),Z=i(1740),g=i(5593),n=i(433),T=i(947),v=i(7579),p=i(2722),t=i(1571),b=i(529),I=i(2340);let P=(()=>{class o{constructor(r){this.http=r,this.apiURLProducts=I.N.apiURL+"products"}getProducts(r){let e=new b.LE;return r&&(e=e.append("categories",r.join(","))),this.http.get(this.apiURLProducts,{params:e})}createProduct(r){return this.http.post(this.apiURLProducts,r)}getProduct(r){return this.http.get(`${this.apiURLProducts}/${r}`)}updateProduct(r,e){return this.http.put(`${this.apiURLProducts}/${e}`,r)}deleteProduct(r){return this.http.delete(`${this.apiURLProducts}/${r}`)}getFeaturedProducts(r){return this.http.get(`${this.apiURLProducts}/get/featured/${r}`)}}return o.\u0275fac=function(r){return new(r||o)(t.LFG(b.eN))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var m=i(805),F=i(2453),U=i(4247),C=i(1383),h=i(7318),q=i(2137);function _(o,s){1&o&&(t.TgZ(0,"tr")(1,"th",10),t._uU(2,"Name "),t._UZ(3,"p-sortIcon",11),t.qZA(),t.TgZ(4,"th"),t._uU(5,"Image"),t.qZA(),t.TgZ(6,"th",12),t._uU(7,"Price "),t._UZ(8,"p-sortIcon",13),t.qZA(),t.TgZ(9,"th",14),t._uU(10,"Stock "),t._UZ(11,"p-sortIcon",15),t.qZA(),t.TgZ(12,"th",16),t._uU(13,"Category "),t._UZ(14,"p-sortIcon",17),t.qZA(),t.TgZ(15,"th",18),t._uU(16,"Created at "),t._UZ(17,"p-sortIcon",19),t.qZA(),t._UZ(18,"th"),t.qZA())}function N(o,s){if(1&o){const r=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._UZ(4,"img",20),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._uU(8),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.qZA(),t.TgZ(11,"td"),t._uU(12),t.ALo(13,"date"),t.qZA(),t.TgZ(14,"td")(15,"p-button",21),t.NdJ("click",function(){const d=t.CHM(r).$implicit,a=t.oxw();return t.KtG(a.deleteProduct(d.id))}),t.qZA(),t.TgZ(16,"p-button",22),t.NdJ("click",function(){const d=t.CHM(r).$implicit,a=t.oxw();return t.KtG(a.updateProduct(d.id))}),t.qZA()()()}if(2&o){const r=s.$implicit;t.xp6(2),t.Oqu(r.name),t.xp6(2),t.Q6J("src",r.image,t.LSH),t.xp6(2),t.Oqu(r.price),t.xp6(2),t.Oqu(r.countInStock),t.xp6(2),t.Oqu(r.category.name),t.xp6(2),t.Oqu(t.xi3(13,6,r.dateCreated,"mediumDate"))}}const x=function(){return{width:"50vw"}};let L=(()=>{class o{constructor(r,e,u,d){this.productsService=r,this.router=e,this.confirmationService=u,this.messageService=d,this.products=[],this.endsubs$=new v.x}ngOnInit(){this._getProducts()}_getProducts(){this.productsService.getProducts().pipe((0,p.R)(this.endsubs$)).subscribe(r=>{this.products=r})}updateProduct(r){this.router.navigateByUrl(`products/form/${r}`)}deleteProduct(r){this.confirmationService.confirm({message:"Are you sure that you want to delete this product?",header:"Delete Product",icon:"pi pi-exclamation-triangle",accept:()=>{this.productsService.deleteProduct(r).pipe((0,p.R)(this.endsubs$)).subscribe({next:()=>{this._getProducts(),this.messageService.add({severity:"success",summary:"Success",detail:"Product is deleted!"})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Product is not deleted!"})}})}})}ngOnDestroy(){this.endsubs$.next(null),this.endsubs$.complete()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(P),t.Y36(l.F0),t.Y36(m.YP),t.Y36(m.ez))},o.\u0275cmp=t.Xpm({type:o,selectors:[["admin-products-list"]],decls:14,vars:7,consts:[[1,"admin-page"],["header","Products","subheader","List of all products"],[1,"grid"],[1,"col-12"],[1,"p-toolbar-group-left"],["routerLink","form","styleClass","p-button-success","label","New","icon","pi pi-plus"],["responsiveLayout","scroll","styleClass","p-datatable-gridlines",3,"paginator","rows","value"],["pTemplate","header"],["pTemplate","body"],["rejectButtonStyleClass","p-button-text",3,"baseZIndex"],["pSortableColumn","name"],["field","name"],["pSortableColumn","price"],["field","price"],["pSortableColumn","stock"],["field","stock"],["pSortableColumn","category"],["field","category"],["pSortableColumn","created"],["field","created"],["alt","",2,"width","100px",3,"src"],["styleClass","p-button-danger mr-2","icon","pi pi-trash",3,"click"],["styleClass","p-button-success","icon","pi pi-pencil",3,"click"]],template:function(r,e){1&r&&(t._UZ(0,"p-toast"),t.TgZ(1,"div",0)(2,"p-card",1)(3,"div",2)(4,"div",3)(5,"p-toolbar")(6,"div",4),t._UZ(7,"p-button",5),t.qZA()()()(),t.TgZ(8,"div",2)(9,"div",3)(10,"p-table",6),t.YNc(11,_,19,0,"ng-template",7),t.YNc(12,N,17,9,"ng-template",8),t.qZA()()()()(),t._UZ(13,"p-confirmDialog",9)),2&r&&(t.xp6(10),t.Q6J("paginator",!0)("rows",10)("value",e.products),t.xp6(3),t.Akn(t.DdM(6,x)),t.Q6J("baseZIndex",1e4))},dependencies:[l.rH,g.zx,F.FN,m.jx,U.Z,C.o,h.iA,h.lQ,h.fz,q.Q,c.uU],encapsulation:2}),o})();var S=i(6610),J=i(1026),Y=i(5047),$=i(4479),D=i(3054),Q=i(7913),k=i(5121);function M(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"Name is required"),t.qZA())}function R(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"Brand is required"),t.qZA())}function V(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"Price is required"),t.qZA())}function w(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"Count in Stock is required"),t.qZA())}function O(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"category required"),t.qZA())}function G(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"description required"),t.qZA())}function z(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"description required"),t.qZA())}function B(o,s){1&o&&(t.TgZ(0,"small",34),t._uU(1,"image is required"),t.qZA())}const y=function(){return{minWidth:"100%"}},E=function(){return{height:"320px"}},A=[{path:"",component:L},{path:"form/:id",component:(()=>{class o{constructor(r,e,u,d,a,H){this.formBuilder=r,this.categoriesService=e,this.productService=u,this.messageService=d,this.location=a,this.route=H,this.editMode=!1,this.isSubmitted=!1,this.categories=[],this.endsubs$=new v.x}ngOnInit(){this._initForm(),this._getCategories(),this._checkEditMode()}_initForm(){this.form=this.formBuilder.group({name:["",n.kI.required],brand:["",n.kI.required],price:["",n.kI.required],category:["",n.kI.required],countInStock:["",n.kI.required],description:["",n.kI.required],richDescription:[""],image:["",n.kI.required],isFeatured:[!1]})}_getCategories(){this.categoriesService.getCategories().pipe((0,p.R)(this.endsubs$)).subscribe(r=>{this.categories=r})}_addProduct(r){this.productService.createProduct(r).subscribe({next:e=>{this.messageService.add({severity:"success",summary:"Success",detail:`Product ${e.name} is created!`}),(0,S.H)(2e3).toPromise().then(()=>{this.location.back()})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Product is not created!"})}})}_updateProduct(r){this.productService.updateProduct(r,this.currentProductId).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"Product  is update!"}),(0,S.H)(2e3).toPromise().then(()=>{this.location.back()})},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Product is not updated!"})}})}_checkEditMode(){this.route.params.subscribe(r=>{r?.id&&(this.editMode=!0,this.currentProductId=r?.id,this.productService.getProduct(r?.id).pipe((0,p.R)(this.endsubs$)).subscribe(e=>{this.productForm?.name.setValue(e.name),this.productForm?.category.setValue(e?.category?.id),this.productForm?.brand.setValue(e.brand),this.productForm?.price.setValue(e.price),this.productForm?.countInStock.setValue(e.countInStock),this.productForm?.isFeatured.setValue(e.isFeatured),this.productForm?.description.setValue(e.description),this.productForm?.richDescription.setValue(e.richDescription),this.imageDisplay=e.image,this.productForm?.image.setValidators([]),this.productForm?.image.updateValueAndValidity()}))})}onSubmit(){if(this.isSubmitted=!0,this.form.invalid)return;const r=new FormData;Object.keys(this.productForm).map(e=>{r.append(e,this.productForm[e].value)}),this.editMode?this._updateProduct(r):this._addProduct(r)}onCancel(){}onImageUpload(r){const e=r.target.files[0];if(e){this.form.patchValue({image:e}),this.form.get("image")?.updateValueAndValidity();const u=new FileReader;u.onload=()=>{this.imageDisplay=u.result},u.readAsDataURL(e)}}get productForm(){return this.form.controls}ngOnDestroy(){this.endsubs$.next(null),this.endsubs$.complete()}}return o.\u0275fac=function(r){return new(r||o)(t.Y36(n.qu),t.Y36(J.G),t.Y36(P),t.Y36(m.ez),t.Y36(c.Ye),t.Y36(l.gz))},o.\u0275cmp=t.Xpm({type:o,selectors:[["admin-products-form"]],decls:71,vars:29,consts:[[1,"admin-page"],[3,"header","subheader"],[1,"grid","mb-5"],[1,"col-12"],[1,"p-toolbar-group-left"],[1,"p-toolbar-group-right"],["styleClass","p-button-primary mr-4","icon","pi pi-plus",3,"label","click"],["styleClass","p-button-secondary","icon","pi pi-arrow-circle-left","label","Cancel"],[1,"grid"],[3,"formGroup"],[1,"card"],[1,"formgrid","grid"],[1,"field","col"],["for","name"],["type","text","id","name","formControlName","name","pInputText","",1,"w-full"],["class","p-error",4,"ngIf"],["for","brand"],["type","text","id","brand","formControlName","brand","pInputText","",1,"w-full"],["for","price"],["formControlName","price","mode","decimal",1,"w-full",3,"useGrouping"],[1,"field","col-4"],["for","countInStock"],["formControlName","countInStock","mode","decimal","inputId","countInStock",3,"useGrouping"],["for","category"],["placeholder","Select a Category","filterBy","name","formControlName","category","optionLabel","name","optionValue","id",3,"filter","showClear","options"],["formControlName","isFeatured"],[1,"field","col-12"],["for","description"],["id","description","formControlName","description","pInputTextarea","",1,"w-full",3,"rows","cols"],["for","richDescription"],["formControlName","richDescription"],["type","file","accept","image/*",1,"p-inputtext",3,"change"],[1,"col-2","mt-2","pl-0"],["alt","",2,"width","100%",3,"src"],[1,"p-error"]],template:function(r,e){1&r&&(t._UZ(0,"p-toast"),t.TgZ(1,"div",0)(2,"p-card",1)(3,"div",2)(4,"div",3)(5,"p-toolbar"),t._UZ(6,"div",4),t.TgZ(7,"div",5)(8,"p-button",6),t.NdJ("click",function(){return e.onSubmit()}),t.qZA(),t._UZ(9,"p-button",7),t.qZA()()()(),t.TgZ(10,"div",8)(11,"div",3)(12,"form",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"label",13),t._uU(17,"Name"),t.qZA(),t._UZ(18,"br")(19,"input",14),t.YNc(20,M,2,0,"small",15),t.qZA(),t.TgZ(21,"div",12)(22,"label",16),t._uU(23,"Brand"),t.qZA(),t._UZ(24,"br")(25,"input",17),t.YNc(26,R,2,0,"small",15),t.qZA(),t.TgZ(27,"div",12)(28,"label",18),t._uU(29,"Price"),t.qZA(),t._UZ(30,"br")(31,"p-inputNumber",19),t.YNc(32,V,2,0,"small",15),t.qZA()(),t.TgZ(33,"div",11)(34,"div",20)(35,"label",21),t._uU(36,"countInStock"),t.qZA(),t._UZ(37,"br")(38,"p-inputNumber",22),t.YNc(39,w,2,0,"small",15),t.qZA(),t.TgZ(40,"div",20)(41,"label",23),t._uU(42,"category"),t.qZA(),t._UZ(43,"br")(44,"p-dropdown",24),t.YNc(45,O,2,0,"small",15),t.qZA(),t.TgZ(46,"div",20)(47,"label",23),t._uU(48,"Is Featured"),t.qZA(),t._UZ(49,"br")(50,"p-inputSwitch",25),t.qZA(),t.TgZ(51,"div",26)(52,"label",27),t._uU(53,"Description"),t.qZA(),t._UZ(54,"br")(55,"textarea",28),t.YNc(56,G,2,0,"small",15),t.qZA(),t.TgZ(57,"div",26)(58,"label",29),t._uU(59,"Product Details"),t.qZA(),t._UZ(60,"br")(61,"p-editor",30),t.YNc(62,z,2,0,"small",15),t.qZA(),t.TgZ(63,"div",26)(64,"label",13),t._uU(65,"Main Image"),t.qZA(),t._UZ(66,"br"),t.TgZ(67,"input",31),t.NdJ("change",function(d){return e.onImageUpload(d)}),t.qZA(),t.YNc(68,B,2,0,"small",15),t.TgZ(69,"div",32),t._UZ(70,"img",33),t.qZA()()()()()()()()()),2&r&&(t.xp6(2),t.Q6J("header",e.editMode?"Edit Product":"Add Product")("subheader",e.editMode?"Edit Product":"Create New Product"),t.xp6(6),t.Q6J("label",e.editMode?"Update":"Create"),t.xp6(4),t.Q6J("formGroup",e.form),t.xp6(8),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.name?null:e.productForm.name.invalid)&&e.isSubmitted),t.xp6(6),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.brand?null:e.productForm.brand.invalid)&&e.isSubmitted),t.xp6(5),t.Q6J("useGrouping",!1),t.xp6(1),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.price?null:e.productForm.price.invalid)&&e.isSubmitted),t.xp6(6),t.Q6J("useGrouping",!1),t.xp6(1),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.countInStock?null:e.productForm.countInStock.invalid)&&e.isSubmitted),t.xp6(5),t.Akn(t.DdM(26,y)),t.Q6J("filter",!0)("showClear",!0)("options",e.categories),t.xp6(1),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.category?null:e.productForm.category.invalid)&&e.isSubmitted),t.xp6(10),t.Q6J("rows",7)("cols",30),t.xp6(1),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.description?null:e.productForm.description.invalid)&&e.isSubmitted),t.xp6(5),t.Akn(t.DdM(27,E)),t.xp6(1),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.description?null:e.productForm.description.invalid)&&e.isSubmitted),t.xp6(5),t.Akn(t.DdM(28,y)),t.xp6(1),t.Q6J("ngIf",(null==e.productForm||null==e.productForm.image?null:e.productForm.image.invalid)&&e.isSubmitted),t.xp6(2),t.Q6J("src",e.imageDisplay,t.LSH))},dependencies:[c.O5,Z.o,g.zx,n._Y,n.Fj,n.JJ,n.JL,F.FN,Y.Rn,$.Lt,U.Z,C.o,D.g,Q.Ql,k.ML,n.sg,n.u],encapsulation:2}),o})()}];let j=(()=>{class o{}return o.\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[c.ez,l.Bz.forChild(A),Z.j,g.hJ,n.u5,T.m,n.UX]}),o})()}}]);